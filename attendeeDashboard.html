<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Revelti - My Dashboard</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Nunito -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="style.css">
</head>
<body class="antialiased text-gray-800">
    <!-- Navbar Placeholder -->
    <div id="navbar-placeholder"></div>

    <!-- Main container with a max-width for larger screens -->
    <div class="max-w-2xl md:max-w-full lg:max-w-full mx-auto bg-white shadow-lg overflow-hidden">

        <!-- Header Section -->
        <header class="p-6 flex items-center">
            <img src="https://placehold.co/80x80/213c63/ffffff?text=A" alt="User Avatar" class="w-20 h-20 rounded-full object-cover shadow-md">
            <div class="ml-4">
                <h1 class="text-3xl font-extrabold revelti-blue">Alex Johnson</h1>
                <p class="text-gray-500">Attendee Dashboard</p>
            </div>
        </header>
        
        <!-- Tab Navigation -->
        <nav class="border-t border-b border-gray-200">
            <div class="flex justify-around">
                <button data-tab-id="following" class="tab-button flex-1 py-3 px-1 text-center text-gray-500 hover:revelti-blue transition duration-300 tab-active">Following</button>
                <button data-tab-id="media" class="tab-button flex-1 py-3 px-1 text-center text-gray-500 hover:revelti-blue transition duration-300">Media</button>
                <button data-tab-id="tickets" class="tab-button flex-1 py-3 px-1 text-center text-gray-500 hover:revelti-blue transition duration-300">My Tickets</button>
                <button data-tab-id="profile" class="tab-button flex-1 py-3 px-1 text-center text-gray-500 hover:revelti-blue transition duration-300">Profile</button>
            </div>
        </nav>

        <!-- Main Content Sections (Tabs) -->
        <main class="p-6 bg-gray-50">
            <!-- Following Tab Content -->
            <div id="following" class="tab-content space-y-6">
                <!-- Content will be loaded dynamically -->
            </div>

            <!-- Media Tab Content -->
            <div id="media" class="tab-content hidden space-y-6">
                <!-- Content will be loaded dynamically -->
            </div>

            <!-- My Tickets Tab Content -->
            <div id="tickets" class="tab-content hidden space-y-6">
                <!-- Content will be loaded dynamically -->
            </div>

            <!-- Profile Tab Content -->
            <div id="profile" class="tab-content hidden space-y-4">
                <!-- Content will be loaded dynamically -->
            </div>
        </main>
    </div>
    
    <!-- Footer Placeholder -->
    <div id="footer-placeholder"></div>

    <!-- Main Script Block for Tab & Content Management -->
    <script>
        // A map to link tab IDs to their corresponding HTML file names.
        const tabContentMap = {
            'following': 'followingTab.html',
            'media': 'mediaTab.html',
            'tickets': 'ticketsTab.html',
            'profile': 'profileTab.html'
        };

        // This function fetches and injects content for a specific tab.
        async function loadTabContent(tabId) {
            const container = document.getElementById(tabId);
            const fileName = tabContentMap[tabId];
            
            // Remove any dynamically added modals from previous tab loads
            const existingMediaModal = document.getElementById('media-modal');
            if (existingMediaModal) existingMediaModal.remove();
            const existingStylesModal = document.getElementById('styles-modal');
            if (existingStylesModal) existingStylesModal.remove();

            if (!container || !fileName) {
                console.error(`Invalid tab ID or file name for: ${tabId}`);
                return;
            }

            try {
                const response = await fetch(fileName);
                if (!response.ok) throw new Error(`Failed to load ${fileName}: ${response.statusText}`);

                const html = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                
                const tabContent = doc.getElementById(tabId);
                
                if (tabContent) {
                        // Clear existing content and inject the new HTML
                        container.innerHTML = tabContent.innerHTML;

                        // Find and inject modals from the fetched content.
                        const mediaModal = doc.getElementById('media-modal');
                        if (mediaModal) document.body.appendChild(mediaModal);
                        
                        const stylesModal = doc.getElementById('styles-modal');
                        if (stylesModal) document.body.appendChild(stylesModal);
                        
                        // Initialize tab-specific functionality
                        if (tabId === 'profile') {
                            // Both of these functions are needed for the profile page
                            updateSelectedStylesDisplay();
                            initializeMediaTabListeners();
                        } else if (tabId === 'media') {
                            initializeMediaTabListeners();
                        }
                    } else {
                        container.innerHTML = `<p>Error: Could not find content with ID "${tabId}" in ${fileName}.</p>`;
                    }
                } catch (error) {
                    console.error(`Error fetching tab content for ${tabId}:`, error);
                    container.innerHTML = `<p>Could not load the content. Please try again later.</p>`;
                }
            }

        // Main function to handle switching between tabs.
        function switchTab(tabId) {
            // Hide all tab content sections.
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });

            // Deactivate all tab navigation links.
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('tab-active');
            });

            // Show the selected tab content.
            const selectedTabContent = document.getElementById(tabId);
            if (selectedTabContent) selectedTabContent.classList.remove('hidden');

            // Activate the selected tab navigation link.
            const selectedTabButton = document.querySelector(`[data-tab-id="${tabId}"]`);
            if (selectedTabButton) selectedTabButton.classList.add('tab-active');

            // Load the content for the selected tab.
            loadTabContent(tabId);
        }

        // Event listener to set up the tab navigation when the page is fully loaded.
        document.addEventListener('DOMContentLoaded', () => {
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.getAttribute('data-tab-id');
                    if (tabId) switchTab(tabId);
                });
            });
            // Load the default tab on initial page load
            switchTab('following');
        });
    </script>

    <!-- External JavaScript for all global functions and modals -->
    <script src="main.js" defer></script>
</body>
</html>
